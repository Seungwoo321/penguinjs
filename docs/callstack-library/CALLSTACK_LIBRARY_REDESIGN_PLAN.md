# 📚 콜스택 도서관 게임 재설계 기획서

## 개요
JavaScript 콜스택 학습을 위한 체계적이고 단계적인 게임 재설계안입니다. 기존 16개 스테이지를 24개로 확장하여, 콜스택의 기초부터 고급 개념까지 완벽하게 마스터할 수 있도록 구성했습니다.

## 현재 문제점 분석
1. **마이크로태스크/매크로태스크 학습 부족**: 전체 16개 스테이지 중 단 2개만이 이벤트 루프 관련
2. **난이도 배분 불균형**: 고급 개념이 너무 압축되어 있음
3. **점진적 학습 부재**: 이벤트 루프 개념이 갑자기 고급에서만 등장
4. **실무 패턴 부족**: 실제 개발에서 자주 마주치는 패턴 부재

## 게임 핵심 목표
- **🎯 주요 학습 목표**: JavaScript 실행 메커니즘의 완벽한 이해
  - 함수 호출과 콜스택의 동작 원리
  - 동기/비동기 코드의 실행 순서
  - 이벤트 루프와 태스크 큐의 우선순위
  - 실무에서 자주 발생하는 실행 순서 문제 해결

## 새로운 스테이지 구성 (총 24개)

### 🟢 초급 (Beginner) - 스테이지 1-8
**테마**: 도서관 사서가 되어 책(함수)을 정리하며 콜스택 기초 학습

| 스테이지 | 제목 | 학습 내용 | 레이아웃 |
|---------|------|-----------|----------|
| 1 | 첫 번째 책 정리 | 단순 함수 호출과 반환 | A |
| 2 | 책장 쌓기 | 함수 내 함수 호출 | A |
| 3 | 연쇄 정리 | 함수 체인 호출 | A |
| 4 | 책 더미 관리 | 콜스택 깊이와 한계 | A |
| 5 | 순환 정리 | 기초 재귀 함수 | A |
| 6 | 효율적 정리 | 반복문 vs 재귀 | A |
| 7 | 정리 순서 | 실행 순서와 반환값 | A |
| 8 | 첫 비동기 체험 | setTimeout 소개 | B |

**초급 특징**:
- 모든 스테이지가 동기 코드 (1-7번)
- 마지막 스테이지에서 setTimeout 첫 소개
- 레이아웃 A 사용 (단순 콜스택)
- 레이아웃 B는 8번에서만 사용 (비동기 개념 도입)

### 🟡 중급 (Intermediate) - 스테이지 1-8
**테마**: 숙련된 사서가 되어 복잡한 책 정리와 예약 시스템 관리

| 스테이지 | 제목 | 학습 내용 | 레이아웃 |
|---------|------|-----------|----------|
| 1 | 복잡한 재귀 | 피보나치와 트리 탐색 | A |
| 2 | 상호 참조 | 상호 재귀 패턴 | A |
| 3 | 고차 함수 | 콜백과 고차 함수 | A |
| 4 | 에러 처리 | try-catch와 스택 추적 | A |
| 5 | 비동기 기초 | setTimeout 심화 | B |
| 6 | Promise 입문 | Promise 기본 개념 | B |
| 7 | 이벤트 루프 소개 | 콜스택과 태스크 큐 | B |
| 8 | 실행 순서 예측 | 동기 vs 비동기 혼합 | B |

**중급 특징**:
- 전반부(1-4): 동기 코드의 고급 패턴
- 후반부(5-8): 비동기 개념 본격 도입
- 레이아웃 A에서 B로 점진적 전환
- 이벤트 루프 개념 단계적 소개

### 🔴 고급 (Advanced) - 스테이지 1-8
**테마**: 도서관 관장이 되어 전체 시스템과 특별 예약 시스템 통합 관리

| 스테이지 | 제목 | 학습 내용 | 레이아웃 |
|---------|------|-----------|----------|
| 1 | 마이크로 vs 매크로 | Promise vs setTimeout | B |
| 2 | 이벤트 루프 심화 | 실행 우선순위 완벽 이해 | B |
| 3 | async/await 패턴 | 동기적 비동기 코드 | B |
| 4 | 제너레이터 | yield와 실행 중단/재개 | C |
| 5 | 복합 비동기 | 여러 비동기 패턴 조합 | C |
| 6 | 애니메이션 프레임 | requestAnimationFrame | C |
| 7 | 실무 패턴 | 디바운스, 쓰로틀 등 | C |
| 8 | 최종 도전 | 모든 개념 통합 | D |

**고급 특징**:
- 이벤트 루프 완전 정복 (1-3)
- 특수 실행 패턴 (4-6)
- 실무 응용 (7-8)
- 레이아웃 B → C → D로 복잡도 증가

## 레이아웃 시스템

### 레이아웃 A: 기본 콜스택 (초급 1-7, 중급 1-4)
- **구조**: 50% 콜스택 시각화 + 50% 코드/예측
- **특징**: 단일 콜스택만 표시
- **색상**: 파란색 테마 (#3b82f6)

### 레이아웃 B: 이벤트 루프 (초급 8, 중급 5-8, 고급 1-3)
- **구조**: 50% 이벤트 루프 시스템 + 50% 코드/예측
- **특징**: 콜스택 + 마이크로태스크 큐 + 매크로태스크 큐
- **색상**: 빨간색 테마 (#dc2626)

### 레이아웃 C: 복합 큐 시스템 (고급 4-7)
- **구조**: 50% 복합 큐 시스템 + 50% 코드/예측
- **특징**: 콜스택 + 4개 특수 큐 (2×2 그리드)
- **색상**: 보라색 테마 (#7c3aed)

### 레이아웃 D: 통합 시스템 (고급 8)
- **구조**: 50% 전체 시스템 + 50% 코드/예측
- **특징**: 모든 실행 컨텍스트 통합 표시
- **색상**: 보라색 테마 유지

## 핵심 개선사항

### 1. 점진적 학습 곡선
- **초급**: 동기 코드만 (7개) → 비동기 맛보기 (1개)
- **중급**: 동기 심화 (4개) → 비동기 기초 (4개)
- **고급**: 이벤트 루프 정복 (3개) → 특수 패턴 (5개)

### 2. 이벤트 루프 학습 강화
- 기존 2개 → 8개 스테이지로 확장
- 초급부터 점진적으로 도입
- 실행 우선순위를 체계적으로 학습

### 3. 실무 연결성
- 디바운스, 쓰로틀 패턴
- async/await 실전 활용
- 애니메이션 프레임 관리

### 4. 시각적 일관성
- 난이도별 색상 테마 적용
- 복잡도에 따른 레이아웃 전환
- 직관적인 큐 시스템 표현

## 게임 메커니즘

### 기본 플레이
1. **코드 분석**: 주어진 JavaScript 코드 읽기
2. **순서 예측**: 드래그 앤 드롭으로 실행 순서 배치
3. **시뮬레이션**: 실제 실행 과정 애니메이션으로 확인
4. **정답 확인**: 예측과 실제 실행 비교

### 특수 기능
- **힌트 시스템**: 단계별 힌트 제공
- **실행 속도 조절**: 애니메이션 속도 컨트롤
- **단계별 실행**: 한 스텝씩 실행 가능
- **개념 설명**: 각 스테이지별 핵심 개념 설명

## 기술 구현 가이드

### 파일 구조
```
src/games/callstack-library/
├── levels/
│   ├── beginner-levels.ts (초급 1-8)
│   ├── intermediate-levels.ts (중급 1-8)
│   └── advanced-levels.ts (고급 1-8)
├── layouts/
│   ├── LayoutTypeA.tsx
│   ├── LayoutTypeB.tsx
│   ├── LayoutTypeC.tsx
│   └── LayoutTypeD.tsx
└── CallStackLibraryGame.tsx
```

### 레벨 데이터 구조
```typescript
interface CallStackLevel {
  id: string
  title: string
  description: string
  explanation: string
  difficulty: 'beginner' | 'intermediate' | 'advanced'
  stageNumber: number
  layoutType: 'A' | 'B' | 'C' | 'D'
  code: string
  functionCalls: FunctionCall[]
  expectedOrder: string[]
  queueTypes?: QueueType[]
  maxStackSize: number
  hints: string[]
  concepts: string[]
}
```

### 구현 우선순위
1. **Phase 1**: 레이아웃 시스템 구현 (A, B, C, D)
2. **Phase 2**: 초급 스테이지 1-8 구현
3. **Phase 3**: 중급 스테이지 9-16 구현
4. **Phase 4**: 고급 스테이지 17-24 구현
5. **Phase 5**: 테스트 및 최적화

## 예상 학습 성과
- **초급 완료 시**: 콜스택 기본 동작 원리 완벽 이해
- **중급 완료 시**: 비동기 코드 실행 순서 예측 가능
- **고급 완료 시**: JavaScript 실행 메커니즘 마스터

## 결론
이 재설계안은 JavaScript 콜스택 학습을 체계적이고 점진적으로 진행할 수 있도록 구성되었습니다. 특히 실무에서 중요한 이벤트 루프와 비동기 패턴을 충분히 다루어, 학습자가 실제 개발 환경에서 마주치는 문제들을 해결할 수 있는 능력을 기를 수 있습니다.