# JSPlayground 데이터 스키마 설계서

## 1. 개요

### 목적
JavaScript 학습 게임 플랫폼의 모든 데이터 구조와 관계를 정의하여 일관된 데이터 관리 제공

### 설계 원칙
- **확장성**: 새로운 게임과 기능 추가에 유연한 구조
- **일관성**: 모든 게임에서 공통된 데이터 패턴 사용
- **성능**: 효율적인 데이터 접근과 저장
- **무결성**: 데이터 검증과 타입 안전성 보장

### 저장 방식
- **클라이언트 사이드 저장**: localStorage 기반
- **백업 지원**: JSON Export/Import 기능
- **동기화**: 수동 백업/복원 지원

---

## 2. 핵심 엔티티 개요

### 데이터 엔티티 계층구조
```
Application State
├── User Profile          # 사용자 프로필
├── Game Collection      # 게임 컬렉션
│   ├── Game Metadata   # 게임 메타데이터
│   └── Stage Data      # 스테이지 데이터
├── Progress System     # 진행도 시스템
│   ├── User Progress   # 사용자 진행도
│   ├── Achievements    # 성취 시스템
│   └── Statistics      # 통계 데이터
├── Settings           # 사용자 설정
└── Session Data       # 세션 임시 데이터
```

---

## 3. 사용자 프로필 (User Profile)

### 기본 사용자 정보
**UserProfile Entity**
- 사용자 고유 식별자
- 사용자명 (변경 가능)
- 프로필 아바타 설정
- 계정 생성 일시
- 마지막 접속 일시
- 선호 언어 설정
- 테마 설정 (라이트/다크)

### 학습 선호도
**LearningPreferences Entity**
- 선호 난이도 설정
- 힌트 사용 선호도
- 애니메이션 속도 설정
- 사운드 효과 설정
- 접근성 옵션 설정

### 사용자 통계
**UserStatistics Entity**
- 총 게임 플레이 시간
- 총 완료한 스테이지 수
- 평균 스테이지 완료 시간
- 선호하는 게임 유형
- 가장 어려워하는 개념
- 학습 연속 일수

---

## 4. 게임 컬렉션 (Game Collection)

### 게임 메타데이터
**GameMetadata Entity**
- 게임 고유 식별자
- 게임 이름 (다국어 지원)
- 게임 설명 (다국어 지원)
- 게임 아이콘 리소스
- 게임 유형 분류
- 학습 목표 JavaScript 개념
- 권장 선수 지식
- 예상 완료 시간
- 게임 버전 정보
- 마지막 업데이트 일시

### 게임 분류 체계
**GameCategory Entity**
- 카테고리 식별자
- 카테고리 이름
- 카테고리 설명
- 카테고리 색상 테마
- 포함된 게임 목록
- 카테고리별 진행도

### 스테이지 메타데이터
**StageMetadata Entity**
- 스테이지 고유 식별자
- 스테이지 번호 (게임 내 순서)
- 스테이지 이름
- 스테이지 설명
- 난이도 레벨 (초급/중급/고급)
- 학습 목표
- 예상 소요 시간
- 선수 스테이지 의존성
- 힌트 정보 목록

---

## 5. 스테이지 콘텐츠 구조

### 문제 정의
**ProblemDefinition Entity**
- 문제 설명 텍스트
- 제공되는 초기 코드 템플릿
- 기대하는 결과값
- 제약 조건 목록
- 허용되는 JavaScript 기능
- 금지된 패턴 목록

### 검증 기준
**ValidationCriteria Entity**
- 정답 검증 함수 정의
- 성능 검증 기준
- 코드 품질 기준
- 부분 점수 기준
- 채점 가중치 정보

### 힌트 시스템
**HintSystem Entity**
- 힌트 단계별 내용
- 힌트 제공 조건
- 힌트 사용 시 점수 차감
- 힌트 유형 (텍스트/코드/시각화)
- 힌트 해제 순서

### 시각화 설정
**VisualizationConfig Entity**
- 시각화 유형 정의
- 애니메이션 설정
- 인터랙션 요소 정의
- 렌더링 옵션
- 반응형 설정

---

## 6. 진행도 시스템 (Progress System)

### 사용자 게임 진행도
**UserGameProgress Entity**
- 사용자-게임 연결 식별자
- 게임 시작 일시
- 마지막 플레이 일시
- 전체 완료 상태
- 현재 활성 스테이지
- 게임별 총 플레이 시간
- 게임별 총 점수

### 스테이지 완료 기록
**StageCompletionRecord Entity**
- 사용자-스테이지 연결 식별자
- 완료 상태 (미시작/진행중/완료/완벽완료)
- 첫 완료 일시
- 마지막 시도 일시
- 총 시도 횟수
- 최고 점수
- 완료 소요 시간
- 사용한 힌트 수
- 코드 솔루션 저장

### 점수 및 평가
**ScoreRecord Entity**
- 기본 점수 (정답 여부)
- 시간 보너스 점수
- 코드 품질 점수
- 힌트 사용 페널티
- 총합 점수
- 백분위 순위
- 평가 등급 (A+, A, B+, B, C)

---

## 7. 성취 시스템 (Achievement System)

### 성취 정의
**AchievementDefinition Entity**
- 성취 고유 식별자
- 성취 이름 (다국어 지원)
- 성취 설명 (다국어 지원)
- 성취 아이콘 리소스
- 성취 유형 분류
- 달성 조건 정의
- 성취 난이도
- 보상 포인트

### 성취 유형 분류
**AchievementType Entity**
- **Progress Achievements**: 진행도 기반 성취
- **Performance Achievements**: 성능 기반 성취
- **Exploration Achievements**: 탐험 기반 성취
- **Social Achievements**: 소셜 기반 성취
- **Mastery Achievements**: 숙련도 기반 성취

### 사용자 성취 기록
**UserAchievementRecord Entity**
- 사용자-성취 연결 식별자
- 달성 일시
- 달성 시점 통계
- 달성 조건 세부 정보
- 관련 스테이지 정보

### 배지 시스템
**BadgeSystem Entity**
- 배지 고유 식별자
- 배지 디자인 정보
- 배지 획득 조건
- 배지 희귀도
- 배지 표시 우선순위

---

## 8. 통계 및 분석 데이터

### 학습 패턴 분석
**LearningAnalytics Entity**
- 시간대별 학습 패턴
- 개념별 이해도 분석
- 실수 패턴 분석
- 학습 효율성 지표
- 복습 필요 개념 목록

### 성능 메트릭
**PerformanceMetrics Entity**
- 스테이지별 평균 완료 시간
- 개념별 정답률
- 힌트 사용 빈도
- 재시도 패턴
- 학습 곡선 데이터

### 사용 패턴
**UsagePatterns Entity**
- 세션별 플레이 시간
- 게임별 선호도
- 중단 지점 분석
- 복귀 패턴 분석
- 기기별 사용 패턴

---

## 9. 설정 시스템 (Settings System)

### 게임 설정
**GameSettings Entity**
- 애니메이션 속도 설정
- 사운드 효과 설정
- 자동 저장 설정
- 힌트 자동 표시 설정
- 코드 에디터 설정

### 접근성 설정
**AccessibilitySettings Entity**
- 고대비 모드 설정
- 모션 감소 설정
- 폰트 크기 설정
- 키보드 네비게이션 설정
- 스크린 리더 호환 설정

### 개인화 설정
**PersonalizationSettings Entity**
- 테마 설정 (라이트/다크/게임별)
- 언어 설정
- 시간대 설정
- 알림 설정
- 백업 설정

---

## 10. 세션 관리 (Session Management)

### 현재 세션 상태
**CurrentSessionState Entity**
- 세션 시작 시간
- 현재 활성 게임
- 현재 활성 스테이지
- 임시 코드 저장
- 임시 설정 변경
- 미완료 액션 목록

### 임시 데이터
**TemporaryData Entity**
- 코드 에디터 임시 저장
- 드래프트 솔루션
- 중간 진행 상태
- 임시 점수 계산
- 세션별 통계

### 캐시 데이터
**CacheData Entity**
- 자주 접근하는 게임 데이터
- 사용자 선호 게임 목록
- 최근 플레이 기록
- 추천 스테이지 목록

---

## 11. 백업 및 동기화

### 백업 데이터 구조
**BackupData Entity**
- 백업 생성 일시
- 백업 버전 정보
- 포함된 데이터 범위
- 백업 무결성 해시
- 복원 호환성 정보

### 내보내기/가져오기
**ExportImportFormat Entity**
- JSON 스키마 버전
- 데이터 압축 설정
- 개인정보 필터링
- 부분 백업 지원
- 마이그레이션 지원

---

## 12. 데이터 검증 및 무결성

### 타입 안전성
**TypeDefinitions**
- 모든 엔티티에 대한 TypeScript 타입 정의
- 런타임 타입 검증
- 스키마 버전 관리
- 마이그레이션 자동화

### 데이터 검증 규칙
**ValidationRules Entity**
- 필수 필드 검증
- 데이터 형식 검증
- 비즈니스 로직 검증
- 참조 무결성 검증
- 범위 및 제약 검증

### 에러 처리
**ErrorHandling Entity**
- 데이터 손상 감지
- 자동 복구 메커니즘
- 에러 로깅
- 사용자 알림
- 백업 복원 절차

---

## 13. 성능 최적화

### 데이터 인덱싱
**IndexingStrategy**
- 자주 조회되는 필드 인덱싱
- 복합 인덱스 최적화
- 검색 성능 향상
- 정렬 성능 최적화

### 캐싱 전략
**CachingStrategy**
- 메모리 캐시 관리
- 로컬 스토리지 최적화
- 데이터 지역성 활용
- 캐시 무효화 정책

### 데이터 압축
**CompressionStrategy**
- JSON 데이터 압축
- 중복 제거
- 델타 압축
- 백그라운드 압축

---

## 14. 프라이버시 및 보안

### 개인정보 보호
**PrivacyProtection**
- 최소 데이터 수집 원칙
- 익명화 데이터 처리
- 사용자 동의 관리
- 데이터 삭제 권한

### 보안 조치
**SecurityMeasures**
- 클라이언트 사이드 암호화
- 무결성 검증
- 악성 코드 방지
- 안전한 백업 절차

---

## 15. 확장성 고려사항

### 스키마 진화
**SchemaEvolution**
- 버전 관리 체계
- 점진적 마이그레이션
- 하위 호환성 유지
- 기능 플래그 지원

### 새로운 게임 유형 지원
**ExtensibilitySupport**
- 플러그인 아키텍처
- 동적 스키마 확장
- 커스텀 검증 규칙
- 유연한 메타데이터 구조

### 다중 플랫폼 지원
**MultiPlatformSupport**
- 플랫폼별 적응
- 동기화 메커니즘
- 클라우드 저장소 연동
- 오프라인 지원